<!DOCTYPE html>
<html class='no-js' xmlns:og='http://ogp.me/ns#'>
<head>
<meta charset='UTF-8' />
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible' />
<meta content='width=device-width, initial-scale=1.0' name='viewport' />
<meta content='How do you use the Paul Irish IE conditional comments hack on HAML? This post shows you a way using HAML helpers.' name='description' />
<meta content='HAML and IE compatibility' property='og:title' />
<meta content='article' property='og:type' />
<meta content='RicoStaCruz.com' property='og:site_name' />
<meta content='169204529787544' property='fb:app_id' />
<meta content='ricostacruz' property='fb:admins' />
<meta content='How do you use the Paul Irish IE conditional comments hack on HAML? This post shows you a way using HAML helpers.' property='og:description' />
<link href='http://ricostacruz.com/images/haml-and-ie-compatibility.jpg' rel='image_src' />
<meta content='http://ricostacruz.com/images/haml-and-ie-compatibility.jpg' property='og:image' />
<title>HAML and IE compatibility</title>
<link href='/css/style.css?1311235162' media='screen' rel='stylesheet' type='text/css' />
<link href='/css/special.css?1311537259' media='screen' rel='stylesheet' type='text/css' />
<link href='/favicon.png' rel='shortcut icon' type='text/css' />
<link href='http://fonts.googleapis.com/css?family=Droid+Sans:regular,bold' rel='stylesheet' type='text/css' />
<link href='http://feeds.feedburner.com/ricostacruz' rel='alternate' title='RicoStaCruz.com' type='application/rss+xml' />
<script type='text/javascript'>
  //<![CDATA[
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-20473929-1']);
    _gaq.push(['_trackPageview']);
    
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  //]]>
</script>

</head>
<body class='page-post'>
<div class='header'>
<a class='home' href='/'>Home</a>
<div class='contact'>
<dl class='start'>
<dt>email</dt>
<dd>
<a href='mailto:rico@ricostacruz.com'>
<span>rico @</span>
<strong>ricostacruz.com</strong>
</a>
</dd>
</dl>
<dl>
<dt>twitter</dt>
<dd>
<a href='http://twitter.com/rstacruz'>
<span>twitter.com /</span>
<strong>rstacruz</strong>
</a>
</dd>
</dl>
<dl>
<dt>behance</dt>
<dd>
<a href='http://behance.net/ricostacruz'>
<span>behance.net /</span>
<strong>ricostacruz</strong>
</a>
</dd>
</dl>
<dl>
<dt>dribbble</dt>
<dd>
<a href='http://dribbble.com/rstacruz'>
<span>dribbble.com /</span>
<strong>rstacruz</strong>
</a>
</dd>
</dl>
<dl>
<dt>github</dt>
<dd>
<a href='http://github.com/rstacruz'>
<span>github.com /</span>
<strong>rstacruz</strong>
</a>
</dd>
</dl>
<dl>
<dt>linkedin</dt>
<dd>
<a href='http://ph.linkedin.com/in/ricostacruz'>
<span>linkedin.com &rarr;</span>
<strong>ricostacruz</strong>
</a>
</dd>
</dl>
</div>
<header></header>
</div>

<article class='post post-2010-10-10'>
<div class='meta'>
<a class='date' href='/2010/haml_and_ie_compatibility.html'>
<span class='year'>2010</span>
<span class='month'>October 10</span>
</a>
<div class='category'>
<em>Filed under</em>
<strong>
Ruby
</strong>
</div>
</div>
<header>
<h2>
<a href='/2010/haml_and_ie_compatibility.html'>HAML and IE compatibility</a>
</h2>
</header>
<p class="brief c3">I love <span class="caps">HAML</span>, and I love the insanely-elegant <a href="http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/">Paul Irish IE conditional comments trick</a> (not hack!). But can we use them together? For those that tried, I&#8217;m sure you know by now that trying to shoehorn the whole snippet as a bunch of <span class="caps">HAML</span> comments is just gross, and impossible.</p>
<section class="flush">
<p><img src="/images/cc_ie_html.png" alt="" /></p>
<div class="caption c1">
<p><strong>Figure 1</strong>.<br />
IE conditional comments allows you to target IE versions easily without any hacks. More info in <a href="http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/">Paul Irish&#8217;s post</a></p>
</div>
</section>
<section class="pt2 nb main">
<div class="c c1">
<h3>Implementing conditional comments: the helpers way</h3>
<p>The solution isn&#8217;t that hard to accomplish! <span class="caps">HAML</span> lets you have helper functions that take in blocks which you can receive in your helper functions as <span class="caps">HTML</span>. I suppose we just put two and two together, and:</p>
</div>
<pre class="c2 fr prettyprint lang-rb">
module ConditionalHtmlHelper
  # Implements the Paul Irish IE conditional comments HTML tag--in HAML.
  # http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/
  def cc_html(options={}, &amp;blk)
    attrs = options.map { |(k, v)| " #{h k}='#{h v}'" }.join('')
    [ "&lt;!--[if lt IE 7 ]&gt; &lt;html#{attrs} class='ie6'&gt; &lt;![endif]--&gt;",
      "&lt;!--[if IE 7 ]&gt;    &lt;html#{attrs} class='ie7'&gt; &lt;![endif]--&gt;",
      "&lt;!--[if IE 8 ]&gt;    &lt;html#{attrs} class='ie8'&gt; &lt;![endif]--&gt;",
      "&lt;!--[if IE 9 ]&gt;    &lt;html#{attrs} class='ie9'&gt; &lt;![endif]--&gt;",
      "&lt;!--[if (gt IE 9)|!(IE)]&gt;&lt;!--&gt; &lt;html#{attrs}&gt; &lt;!--&lt;![endif]--&gt;",
      capture_haml(&amp;blk).strip,
      "&lt;/html&gt;"
    ].join("\n")
  end

  def h(str); Rack::Utils.escape_html(str); end
end

# Assuming Main is your Sinatra app
Main.helpers ConditionalHtmlHelper
</pre>
<div class="c c1">
<h3>Usage in <span class="caps">HAML</span></h3>
<p>Now in your <span class="caps">HAML</span> layouts, instead of using <code>%html</code>, use the new helper like so:</p>
</div>
<pre class="c2 fr prettyprint lang-rb">
!!! 5
!= cc_html(:lang =&gt; 'en') do
  %head
    %meta(charset='UTF-8')
    %title Hello!

  %body
    ...
</pre>
</section>
<section class="alert">
<div class="c1">
<h3>Oh, and one more thing&#8230;</h3>
<p>This will make it dirt easy to implement IE-specific stuff in <span class="caps">SCSS</span>. Thanks to <a href="http://twitter.com/marcopalinar">@marcopalinar</a> for the tip.</p>
</div>
<pre class="c1 prettyprint lang-css">
/* Fix the double margin bug */
.posts {
    margin-left: 10px;
    .ie6 &amp; { margin-left: 5px; }
}
</pre>

<pre class="c1 prettyprint lang-css">
/* Upgrade notice */
.upgrade-your-browser {
  &amp; { display: none; }
  .ie6 &amp; { display: block; }
}
</pre>
</section>
<h3 class="c c2">That&#8217;s it!</h3>
<p class="c c2">Aura now has all it&#8217;s views peppered with the conditional comments trick. Still no IE compatibility, though&#8230; that&#8217;ll come later. By the way, there may be a better solution <a href="https://gist.github.com/636041">here</a>. As usual, you can check the demo site at <a href="http://aurademo.heroku.com">aurademo.heroku.com</a>.</p>
</article>
<section class='comments'>
<div id="fb-root"></div><script src="http://connect.facebook.net/en_US/all.js#appId=169204529787544&amp;xfbml=1"></script><fb:comments numposts="100" width="930" publish_feed="true"></fb:comments>
</section>
<footer class='colophon'>
<div class='before'>
<span>&rarr;</span>
</div>
<h3>Hi.</h3>
<div class='info'>
<p>
I'm
<strong>Rico Sta Cruz.</strong>
I'm a designer by trade, musician by hobby, and Ruby hacker by day&mdash;saving the world one web app at a time.
</p>
</div>
<div class='info'>
<p>
I am currently working with
<a href='http://sinefunc.com'>Sinefunc, Inc.</a>
as it's UI expert, co-founder, and team motivator.
<br />
And
<a href='http://twitter.com/rstacruz'>you should follow me on Twitter.</a>
</p>
</div>
<div class='links'></div>
</footer>
<footer id='footer'>
<div class='lol'>
<span>&copy;</span>
</div>
<div class='copyright'>
<strong>&copy;2010, Rico Sta. Cruz.</strong>
<br />
Some rights reserved.
</div>
<div class='wide'>
Except where otherwise noted, content on this site is
licensed under a
<a href='http://creativecommons.org/licenses/by/3.0/'>Creative Commons Attribution 3.0&nbsp;License</a><span>.</span></div>
<div class='hosting wide'>
This site is graciously hosted by
<a href='http://github.com/'>GitHub</a>
and powered by Sinefunc's
<a href='http://github.com/sinefunc/hyde'>Hyde.</a>
The source can be seen
<a href='http://github.com/rstacruz/rstacruz.github.com/tree/hyde'>here.</a>
</div>
<div class='last'>
&nbsp;
</div>
</footer>


<script src='http://cachedcommons.org/cache/prettify/1.0.0/javascripts/prettify-min.js' type='text/javascript'></script>
<script type='text/javascript'>
  //<![CDATA[
    prettyPrint();
  //]]>
</script>
</body>
</html>
